// -----------------------------------------------------------------------------
// Embarrassing hacks and other unexplained code.
// -----------------------------------------------------------------------------
